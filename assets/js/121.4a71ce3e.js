(window.webpackJsonp=window.webpackJsonp||[]).push([[121],{479:function(s,e,a){"use strict";a.r(e);var t=a(44),l=Object(t.a)({},(function(){var s=this,e=s.$createElement,a=s._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("Docker安装")]),s._v(" "),a("h2",{attrs:{id:"介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#介绍"}},[s._v("#")]),s._v(" 介绍")]),s._v(" "),a("p",[s._v("[TOC]")]),s._v(" "),a("p",[a("strong",[s._v("主机配置:")])]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("主机名")]),s._v(" "),a("th",[s._v("IP地址")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("worker")]),s._v(" "),a("td",[s._v("192.168.153.100")])])])]),s._v(" "),a("p",[a("strong",[s._v("系统：CentOS7")])]),s._v(" "),a("p",[a("strong",[s._v("版本：19.03.5")])]),s._v(" "),a("p",[a("strong",[s._v("1. Docker安装")])]),s._v(" "),a("ul",[a("li",[s._v("更新Yum包")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("yum update\n")])])]),a("ul",[a("li",[s._v("安装 yum-utils , 使用 yum-config-manager 工具设置Yum源, 后面两个是 devicemapper驱动依赖")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y yum-utils device-mapper-persistent-data lvm2\n")])])]),a("ul",[a("li",[s._v("添加docker的yum源")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#国外镜像")]),s._v("\nyum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#国内镜像")]),s._v("\nyum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n")])])]),a("ul",[a("li",[s._v("查看所有仓库中docker版本")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("yum list docker-ce --showduplicates "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sort")]),s._v(" -r\n")])])]),a("ul",[a("li",[s._v("安装Docker，命令：yum install docker-ce-版本号")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#安装最新版本")]),s._v("\nyum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-ce\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#安装指定版本")]),s._v("\nyum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-ce-18.03.1.ce\n")])])]),a("ul",[a("li",[s._v("启动Docker")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("systemctl start docker\n")])])]),a("ul",[a("li",[s._v("验证是否启动成功:")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("docker run hello-world\n")])])]),a("ul",[a("li",[s._v("开机启动")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("systemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" docker\n")])])]),a("ul",[a("li",[s._v("查看docker版本")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("docker version\n")])])]),a("ul",[a("li",[s._v("开启远程访问")])]),s._v(" "),a("p",[s._v("配置/usr/lib/systemd/system/docker.service，添加如下配置")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ExecStart")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/bin/dockerd -H fd:// --containerd"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/run/containerd/containerd.sock  -H tcp://0.0.0.0:2375 -H unix://var/run/docker.sock\n")])])]),a("ul",[a("li",[s._v("重启docker")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("systemctl daemon-reload\nsystemctl restart docker\n")])])]),a("ul",[a("li",[s._v("验证是否添加成功")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -ef"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" docker\n")])])]),a("p",[a("strong",[s._v("2. Docker卸载")])]),s._v(" "),a("ul",[a("li",[s._v("列出你已安装的Docker")])]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("yum list installed | grep docker\n")])])]),a("ul",[a("li",[s._v("移除这个package")])]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("yum -y remove docker-engine.x86_64\n")])])]),a("ul",[a("li",[s._v("要删除所有的images、containers、volumes")])]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("rm -rf /var/lib/docker\n")])])])])}),[],!1,null,null,null);e.default=l.exports}}]);