(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{398:function(a,e,s){"use strict";s.r(e);var t=s(44),r=Object(t.a)({},(function(){var a=this,e=a.$createElement,s=a._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"centos7下azkaban搭建"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#centos7下azkaban搭建"}},[a._v("#")]),a._v(" Centos7下Azkaban搭建")]),a._v(" "),s("h2",{attrs:{id:"介绍"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#介绍"}},[a._v("#")]),a._v(" 介绍")]),a._v(" "),s("p",[a._v("[TOC]")]),a._v(" "),s("p",[s("strong",[a._v("安装环境：")])]),a._v(" "),s("p",[s("strong",[a._v("system：CentOS7")])]),a._v(" "),s("p",[s("strong",[a._v("azkaban:azkaban-3.73.1")])]),a._v(" "),s("h2",{attrs:{id:"jdk安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jdk安装"}},[a._v("#")]),a._v(" jdk安装")]),a._v(" "),s("ol",[s("li",[s("p",[a._v("解压jdk包")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("tar")]),a._v(" -zvxf jdk-8u201-linux-x64.tar.gz\n")])])])]),a._v(" "),s("li",[s("p",[a._v("配置环境变量")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#修改/etc下profile文件，加入以下配置并使用source /etc/profile命令使之生效")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#Java")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("JAVA_HOME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/apps/jdk1.8.0_201\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("CLASSPATH")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(".:"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$JAVA_HOME")]),a._v("/jre/lib/rt.jar:"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$JAVA_HOME")]),a._v("/lib/dt.jar:"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$JAVA_HOME")]),a._v("/lib/tools.jar \n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("PATH")])]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$PATH")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$JAVA_HOME")]),a._v("/bin\n")])])])])]),a._v(" "),s("h2",{attrs:{id:"git安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#git安装"}},[a._v("#")]),a._v(" git安装")]),a._v(" "),s("ol",[s("li",[s("p",[a._v("安装命令")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("yum "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("git")]),a._v("\n")])])])]),a._v(" "),s("li",[s("p",[a._v("查看版本")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("git")]),a._v(" --version\n")])])])])]),a._v(" "),s("h2",{attrs:{id:"azkaban-安装模式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#azkaban-安装模式"}},[a._v("#")]),a._v(" Azkaban 安装模式")]),a._v(" "),s("p",[a._v("Azkaban 有三种部署方式：单服务模式、2个服务模式、分布式多服务模式")]),a._v(" "),s("p",[a._v("solo server model（单服务模式）：该模式中 webServer 和 executorServer 运行在同一个进程中，进程名是AzkabanSingleServer。可以使用自带的H2数据库或者配置mysql数据。该模式适用于小规模的使用。此模式合适个人试用使用。它也可以用在小规模的使用案例中。")]),a._v(" "),s("p",[a._v("two server model（2个服务模式）：数据库为mysql，采用主从设置进行备份，管理服务器（webServer）和执行服务器（executorServer）在不同进程中运行，这种模式下，管理服务器和执行服务器互不影响。适用在较重的生成环境中。")]),a._v(" "),s("p",[a._v("multiple-executor（分布式多服务模式）：存放元数据的数据库为mysql，采用主从设置进行备份，管理服务器（webServer）和执行服务器（executorServer）在不同进程中运行。多个 Executor 模式为最重的生产环境。")]),a._v(" "),s("h2",{attrs:{id:"azkaban单服务模式安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#azkaban单服务模式安装"}},[a._v("#")]),a._v(" Azkaban单服务模式安装")]),a._v(" "),s("ol",[s("li",[s("p",[a._v("解压azkaban包")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("tar")]),a._v(" -zvxf azkaban-3.73.1.tar.gz\n")])])])]),a._v(" "),s("li",[s("p",[a._v("编译源码")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" azkaban-3.73.1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" \n./gradlew build installDist\n")])])])]),a._v(" "),s("li",[s("p",[a._v("启动azkaban")]),a._v(" "),s("ul",[s("li",[s("p",[a._v("执行如下命令")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" azkaban-solo-server/build/install/azkaban-solo-server"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" \nbin/start-solo.sh\n")])])])])])]),a._v(" "),s("li",[s("p",[a._v("浏览器访问http://localhost:8081/")])]),a._v(" "),s("li",[s("p",[a._v("备注：运行时请到执行文件上一层进行运行，否则服务运行不起来。")])])]),a._v(" "),s("h2",{attrs:{id:"azkaban多服务模式安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#azkaban多服务模式安装"}},[a._v("#")]),a._v(" Azkaban多服务模式安装")]),a._v(" "),s("h3",{attrs:{id:"_4、安装步骤"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4、安装步骤"}},[a._v("#")]),a._v(" 4、安装步骤")]),a._v(" "),s("h4",{attrs:{id:"_1-上传安装包并解压缩到指定目录"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-上传安装包并解压缩到指定目录"}},[a._v("#")]),a._v(" （1）上传安装包并解压缩到指定目录")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("[hadoop@hadoop3 ~]$ tar -zxvf azkaban-web-server-2.5.0.tar.gz -C apps/azkaban-2.5.0/\n[hadoop@hadoop3 ~]$ tar -zxvf azkaban-executor-server-2.5.0.tar.gz -C apps/azkaban-2.5.0/\n")])])]),s("h4",{attrs:{id:"_2-解压初始化脚本"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-解压初始化脚本"}},[a._v("#")]),a._v(" （2）解压初始化脚本")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("[hadoop@hadoop3 ~]$ tar -zxvf azkaban-sql-script-2.5.0.tar.gz \n[hadoop@hadoop3 ~]$ cd azkaban-2.5.0/\n[hadoop@hadoop3 azkaban-2.5.0]$ ll\n总用量 88\n-rwxr-xr-x 1 hadoop hadoop  129 4月  22 2014 create.active_executing_flows.sql\n-rwxr-xr-x 1 hadoop hadoop  216 4月  22 2014 create.active_sla.sql\n-rwxr-xr-x 1 hadoop hadoop 4694 4月  22 2014 create-all-sql-2.5.0.sql\n-rwxr-xr-x 1 hadoop hadoop  610 4月  22 2014 create.execution_flows.sql\n-rwxr-xr-x 1 hadoop hadoop  519 4月  22 2014 create.execution_jobs.sql\n-rwxr-xr-x 1 hadoop hadoop  358 4月  22 2014 create.execution_logs.sql\n-rwxr-xr-x 1 hadoop hadoop  224 4月  22 2014 create.project_events.sql\n-rwxr-xr-x 1 hadoop hadoop  227 4月  22 2014 create.project_files.sql\n-rwxr-xr-x 1 hadoop hadoop  280 4月  22 2014 create.project_flows.sql\n-rwxr-xr-x 1 hadoop hadoop  285 4月  22 2014 create.project_permissions.sql\n-rwxr-xr-x 1 hadoop hadoop  294 4月  22 2014 create.project_properties.sql\n-rwxr-xr-x 1 hadoop hadoop  380 4月  22 2014 create.projects.sql\n-rwxr-xr-x 1 hadoop hadoop  325 4月  22 2014 create.project_versions.sql\n-rwxr-xr-x 1 hadoop hadoop  155 4月  22 2014 create.properties.sql\n-rwxr-xr-x 1 hadoop hadoop  498 4月  22 2014 create.schedules.sql\n-rwxr-xr-x 1 hadoop hadoop  189 4月  22 2014 create.triggers.sql\n-rwxr-xr-x 1 hadoop hadoop   22 4月  22 2014 database.properties\n-rwxr-xr-x 1 hadoop hadoop  671 4月  22 2014 update-all-sql-2.1.sql\n-rwxr-xr-x 1 hadoop hadoop  156 4月  22 2014 update-all-sql-2.2.sql\n-rwxr-xr-x 1 hadoop hadoop  395 4月  22 2014 update.execution_logs.2.1.sql\n-rwxr-xr-x 1 hadoop hadoop   59 4月  22 2014 update.project_properties.2.1.sql\n[hadoop@hadoop3 azkaban-2.5.0]$ \n")])])]),s("h4",{attrs:{id:"_3-在mysql中执行脚本create-all-sql-2-5-0-sql-在mysql所在的服务器上执行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-在mysql中执行脚本create-all-sql-2-5-0-sql-在mysql所在的服务器上执行"}},[a._v("#")]),a._v(" （3）在MySQL中执行脚本"),s("strong",[a._v("create-all-sql-2.5.0.sql（在MySQL所在的服务器上执行）")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("mysql> create database azkaban;\nQuery OK, 1 row affected (0.01 sec)\n\nmysql> use azkaban;\nDatabase changed\nmysql> source /home/hadoop/azkaban-2.5.0/create-all-sql-2.5.0.sql\n")])])]),s("p",[s("img",{attrs:{src:"images/1228818-20180412163613230-1229781651.png",alt:"img"}})]),a._v(" "),s("p",[s("img",{attrs:{src:"images/1228818-20180412163649958-1977961615.png",alt:"img"}})]),a._v(" "),s("h4",{attrs:{id:"_4-创建ssl配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-创建ssl配置"}},[a._v("#")]),a._v(" （4）创建SSL配置")]),a._v(" "),s("p",[a._v("参考地址: http://docs.codehaus.org/display/JETTY/How+to+configure+SSL")]),a._v(" "),s("p",[a._v("最好是在 /home/hadoop/apps/azkaban-2.5.0 目录下： 执行命令: keytool -keystore keystore -alias jetty -genkey -keyalg RSA")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("[hadoop@hadoop3 azkaban-2.5.0]$ keytool -keystore keystore -alias jetty -genkey -keyalg RSA\n输入密钥库口令:  \n再次输入新口令: \n您的名字与姓氏是什么?\n  [Unknown]:  \n您的组织单位名称是什么?\n  [Unknown]:  \n您的组织名称是什么?\n  [Unknown]:  \n您所在的城市或区域名称是什么?\n  [Unknown]:  \n您所在的省/市/自治区名称是什么?\n  [Unknown]:  \n该单位的双字母国家/地区代码是什么?\n  [Unknown]:  CN\nCN=Unknown, OU=Unknown, O=Unknown, L=Unknown, ST=Unknown, C=CN是否正确?\n  [否]:  是\n\n输入 <jetty> 的密钥口令\n    (如果和密钥库口令相同, 按回车):  \n[hadoop@hadoop3 azkaban-2.5.0]$ \n")])])]),s("p",[s("img",{attrs:{src:"images/1228818-20180412164112434-407711884.png",alt:"img"}})]),a._v(" "),s("p",[a._v("完成上述工作后,将在当前目录生成 keystore 证书文件,将 keystore 拷贝到 azkaban web 服务 器根目录中.如:")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("hadoop@hadoop3 azkaban-2.5.0]$ mv keystore azkaban-web-2.5.0/\n")])])]),s("h4",{attrs:{id:"_5-修改时区"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-修改时区"}},[a._v("#")]),a._v(" （5）修改时区")]),a._v(" "),s("p",[a._v("注：先配置好服务器节点上的时区")]),a._v(" "),s("p",[a._v("1、先生成时区配置文件 Asia/Shanghai，用交互式命令 tzselect 即可")]),a._v(" "),s("p",[a._v("2、拷贝该时区文件，覆盖系统本地时区配置")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("[hadoop@hadoop3 azkaban-2.5.0]$ sudo cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\n")])])]),s("h4",{attrs:{id:"_6-修改azkaban-web-服务器配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-修改azkaban-web-服务器配置"}},[a._v("#")]),a._v(" （6）修改azkaban web 服务器配置")]),a._v(" "),s("p",[a._v("进入 azkaban web 服务器安装目录 conf 目录")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("[hadoop@hadoop3 ~]$ cd apps/azkaban-2.5.0/azkaban-web-2.5.0/conf/\n")])])]),s("p",[a._v("修改 "),s("strong",[a._v("azkaban.properties")]),a._v(" 文件")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("[hadoop@hadoop3 conf]$ vi azkaban.properties\n")])])]),s("p",[a._v("内容说明如下：")]),a._v(" "),s("blockquote",[s("p",[a._v("#Azkaban Personalization Settings")]),a._v(" "),s("p",[a._v("azkaban.name=MyTestAzkaban #服务器 UI 名称,用于服务器上方显示的名字")]),a._v(" "),s("p",[a._v("azkaban.label=My Local Azkaban #描述")]),a._v(" "),s("p",[a._v("azkaban.color=#FF3601 #UI 颜色")]),a._v(" "),s("p",[a._v("azkaban.default.servlet.path=/index")]),a._v(" "),s("p",[a._v("web.resource.dir=/home/hadoop/apps/azkaban-2.5.0/azkaban-web-2.5.0/web/ #默认根 web 目录")]),a._v(" "),s("p",[a._v("default.timezone.id=Asia/Shanghai #默认时区,已改为亚洲/上海 默认为美国")]),a._v(" "),s("p",[a._v("#Azkaban UserManager class")]),a._v(" "),s("p",[a._v("user.manager.class=azkaban.user.XmlUserManager #用户权限管理默认类")]),a._v(" "),s("p",[a._v("user.manager.xml.file=/home/hadoop/apps/azkaban-2.5.0/azkaban-web-2.5.0/conf/azkaban-users.xml #用户配置,具体配置参加下文")]),a._v(" "),s("p",[a._v("#Loader for projects # global 配置文件所在位置")]),a._v(" "),s("p",[a._v("executor.global.properties=/home/hadoop/apps/azkaban-2.5.0/azkaban-executor-2.5.0/conf/global.properties")]),a._v(" "),s("p",[a._v("azkaban.project.dir=projects")]),a._v(" "),s("p",[a._v("database.type=mysql #数据库类型")]),a._v(" "),s("p",[a._v("mysql.port=3306 #端口号")]),a._v(" "),s("p",[a._v("mysql.host=hadoop03 #数据库连接 IP")]),a._v(" "),s("p",[a._v("mysql.database=azkaban #数据库实例名")]),a._v(" "),s("p",[a._v("mysql.user=root #数据库用户名")]),a._v(" "),s("p",[a._v("mysql.password=root #数据库密码")]),a._v(" "),s("p",[a._v("mysql.numconnections=100 #最大连接数")]),a._v(" "),s("p",[a._v("# Velocity dev mode")]),a._v(" "),s("p",[a._v("velocity.dev.mode=false # Jetty 服务器属性.")]),a._v(" "),s("p",[a._v("jetty.maxThreads=25 #最大线程数")]),a._v(" "),s("p",[a._v("jetty.ssl.port=8443 #Jetty SSL 端口")]),a._v(" "),s("p",[a._v("jetty.port=8081 #Jetty 端口")]),a._v(" "),s("p",[a._v("jetty.keystore=/home/hadoop/apps/azkaban-2.5.0/azkaban-web-2.5.0/keystore #SSL 文件名")]),a._v(" "),s("p",[a._v("jetty.password=hadoop #SSL 文件密码")]),a._v(" "),s("p",[a._v("jetty.keypassword=hadoop #Jetty 主密码 与 keystore 文件相同")]),a._v(" "),s("p",[a._v("jetty.truststore=/home/hadoop/apps/azkaban-2.5.0/azkaban-web-2.5.0/keystore #SSL 文件名")]),a._v(" "),s("p",[a._v("jetty.trustpassword=hadoop # SSL 文件密码")]),a._v(" "),s("p",[a._v("# 执行服务器属性")]),a._v(" "),s("p",[a._v("executor.port=12321 #执行服务器端口")]),a._v(" "),s("p",[a._v("# 邮件设置(可选项)")]),a._v(" "),s("p",[a._v("mail.sender=xxxxxxxx@163.com #发送邮箱")]),a._v(" "),s("p",[a._v("mail.host=smtp.163.com #发送邮箱 smtp 地址")]),a._v(" "),s("p",[a._v("mail.user=xxxxxxxx #发送邮件时显示的名称")]),a._v(" "),s("p",[a._v("mail.password=********** #邮箱密码")]),a._v(" "),s("p",[a._v("job.failure.email=xxxxxxxx@163.com #任务失败时发送邮件的地址")]),a._v(" "),s("p",[a._v("job.success.email=xxxxxxxx@163.com #任务成功时发送邮件的地址")]),a._v(" "),s("p",[a._v("lockdown.create.projects=false # cache.directory=cache #缓存目录")])]),a._v(" "),s("p",[a._v("修改 "),s("strong",[a._v("azkaban-users.xml")]),a._v("配置文件")]),a._v(" "),s("p",[a._v("用户配置 进入 azkaban web 服务器 conf 目录,修改 azkaban-users.xml vi azkaban-users.xml 增加 管理员用户")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('<azkaban-users>\n<user username="azkaban" password="azkaban" roles="admin" groups="azkaban" />\n<user username="metrics" password="metrics" roles="metrics"/>\n<user username="admin" password="admin" roles="admin,metrics" />\n<role name="admin" permissions="ADMIN" />\n<role name="metrics" permissions="METRICS"/>\n</azkaban-users>\n')])])]),s("h4",{attrs:{id:"_6-修改azkaban-executor服务器配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-修改azkaban-executor服务器配置"}},[a._v("#")]),a._v(" （6）修改azkaban executor服务器配置")]),a._v(" "),s("p",[a._v("进入 azkaban executor 服务器安装目录 conf 目录")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("[hadoop@hadoop3 ~]$ cd apps/azkaban-2.5.0/azkaban-executor-2.5.0/conf/\n")])])]),s("p",[a._v("修改"),s("strong",[a._v("azkaban.properties")]),a._v("文件")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("[hadoop@hadoop3 conf]$ vi azkaban.properties \n")])])]),s("blockquote",[s("p",[a._v("#Azkaban")]),a._v(" "),s("p",[a._v("default.timezone.id=Asia/Shanghai #时区")]),a._v(" "),s("p",[a._v("# Azkaban JobTypes 插件配置，插件所在位置")]),a._v(" "),s("p",[a._v("azkaban.jobtype.plugin.dir=/home/hadoop/apps/azkaban-2.5.0/azkaban-executor-2.5.0/plugins/jobtypes")]),a._v(" "),s("p",[a._v("#Loader for projects")]),a._v(" "),s("p",[a._v("executor.global.properties=/home/hadoop/apps/azkaban-2.5.0/azkaban-executor-2.5.0/conf/global.properties")]),a._v(" "),s("p",[a._v("azkaban.project.dir=projects")]),a._v(" "),s("p",[a._v("#数据库设置")]),a._v(" "),s("p",[a._v("database.type=mysql #数据库类型(目前只支持 mysql)")]),a._v(" "),s("p",[a._v("mysql.port=3306 #数据库端口号")]),a._v(" "),s("p",[a._v("mysql.host=hadoop03 #数据库 IP 地址")]),a._v(" "),s("p",[a._v("mysql.database=azkaban #数据库实例名")]),a._v(" "),s("p",[a._v("mysql.user=root #数据库用户名")]),a._v(" "),s("p",[a._v("mysql.password=root #数据库密码")]),a._v(" "),s("p",[a._v("mysql.numconnections=100 #最大连接数")]),a._v(" "),s("p",[a._v("# 执行服务器配置")]),a._v(" "),s("p",[a._v("executor.maxThreads=50 #最大线程数")]),a._v(" "),s("p",[a._v("executor.port=12321 #端口号(如修改,请与 web 服务中一致)")]),a._v(" "),s("p",[a._v("executor.flow.threads=30 #线程数")])]),a._v(" "),s("h4",{attrs:{id:"_7-配置环境变量"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-配置环境变量"}},[a._v("#")]),a._v(" （7）配置环境变量")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("[hadoop@hadoop3 ~]$ vi .bashrc \n#Azkban\nexport AZKABAN_WEB_HOME=/home/hadoop/apps/azkaban-2.5.0/azkaban-web-2.5.0\nexport AZKABAN_EXE_HOME=/home/hadoop/apps/azkaban-2.5.0/azkaban-executor-2.5.0\nexport PATH=$PATH:$AZKABAN_WEB_HOME/bin:$AZKABAN_EXE_HOME/bin\n")])])]),s("p",[a._v("保存之后使其立即生效")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("[hadoop@hadoop3 ~]$ source .bashrc \n")])])]),s("h3",{attrs:{id:"_5、启动"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5、启动"}},[a._v("#")]),a._v(" 5、启动")]),a._v(" "),s("h4",{attrs:{id:"_1-启动-web-服务器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-启动-web-服务器"}},[a._v("#")]),a._v(" （1）启动 web 服务器")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("[hadoop@hadoop3 ~]$ azkaban-web-start.sh\n")])])]),s("p",[a._v("后台启动方式")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("nohup azkaban-web-start.sh 1>/home/hadoop/azwebstd.out 2>/home/hadoop/azweberr.out &\n")])])]),s("p",[a._v("报错信息：")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('Exception in thread "main" java.lang.NoClassDefFoundError: Could not initialize class org.apache.derby.jdbc.AutoloadedDriver40\n    at java.lang.Class.forName0(Native Method)\n    at java.lang.Class.forName(Class.java:348)\n    at java.sql.DriverManager.isDriverAllowed(DriverManager.java:556)\n    at java.sql.DriverManager.isDriverAllowed(DriverManager.java:548)\n    at java.sql.DriverManager.getDrivers(DriverManager.java:446)\n    at org.apache.commons.dbcp.BasicDataSource.<clinit>(BasicDataSource.java:57)\n    at azkaban.database.DataSourceUtils.getMySQLDataSource(DataSourceUtils.java:98)\n    at azkaban.database.DataSourceUtils.getDataSource(DataSourceUtils.java:76)\n    at azkaban.database.AbstractJdbcLoader.<init>(AbstractJdbcLoader.java:63)\n    at azkaban.executor.JdbcExecutorLoader.<init>(JdbcExecutorLoader.java:59)\n    at azkaban.webapp.AzkabanWebServer.loadExecutorManager(AzkabanWebServer.java:247)\n    at azkaban.webapp.AzkabanWebServer.<init>(AzkabanWebServer.java:185)\n    at azkaban.webapp.AzkabanWebServer.main(AzkabanWebServer.java:726)\n')])])]),s("p",[s("img",{attrs:{src:"images/1228818-20180412171937399-1836822562.png",alt:"img"}})]),a._v(" "),s("p",[a._v("需要将derby-10.11.1.1.jar放到/home/hadoop/apps/azkaban-2.5.0/azkaban-web-2.5.0/lib和/home/hadoop/apps/azkaban-2.5.0/azkaban-executor-2.5.0/lib目录中")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("[hadoop@hadoop3 ~]$ cp derby-10.11.1.1.jar apps/azkaban-2.5.0/azkaban-web-2.5.0/lib/\n[hadoop@hadoop3 ~]$ cp derby-10.11.1.1.jar apps/azkaban-2.5.0/azkaban-executor-2.5.0/lib/\n")])])]),s("p",[a._v("此时在重新启动azkaban仍旧报错")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("Exception in thread \"main\" java.lang.IllegalArgumentException: The datetime zone id 'Asia/Shanghai ' is not recognised\n    at org.joda.time.DateTimeZone.forID(DateTimeZone.java:223)\n    at azkaban.webapp.AzkabanWebServer.<init>(AzkabanWebServer.java:208)\n    at azkaban.webapp.AzkabanWebServer.main(AzkabanWebServer.java:726)\n")])])]),s("p",[s("img",{attrs:{src:"images/1228818-20180412194330506-495077093.png",alt:"img"}})]),a._v(" "),s("p",[a._v("排查发现是Azkaban的配置文件"),s("strong",[a._v("azkaban-web-2.5.0/conf/azkaban.properties中的时区配置后面多了一个空格导致")])]),a._v(" "),s("p",[s("strong",[a._v("注意：Azkaban的配置文件中不能有空格")])]),a._v(" "),s("p",[s("img",{attrs:{src:"images/1228818-20180412194658137-479658733.png",alt:"img"}})]),a._v(" "),s("p",[a._v("去掉空格之后再次启动azkaban，启动成功")]),a._v(" "),s("p",[s("img",{attrs:{src:"images/1228818-20180412194846827-1957267584.png",alt:"img"}})]),a._v(" "),s("h4",{attrs:{id:"_2-启动executor服务器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-启动executor服务器"}},[a._v("#")]),a._v(" （2）启动executor服务器")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("[hadoop@hadoop3 ~]$ azkaban-executor-start.sh\n")])])]),s("p",[a._v("后台启动方式")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("nohup azkaban-executor-start.sh 1>/home/hadoop/azexstd.out 2>/home/hadoop/azexerr.out &\n")])])]),s("p",[s("img",{attrs:{src:"images/1228818-20180412195103608-2082827894.png",alt:"img"}})]),a._v(" "),s("h3",{attrs:{id:"_6、验证"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6、验证"}},[a._v("#")]),a._v(" 6、验证")]),a._v(" "),s("p",[a._v("打开谷歌或是火狐浏览器输入https://IP:8443，此处测试的地址是https://hadoop3:8443，此时可能会出现以下界面，点击高级")]),a._v(" "),s("p",[s("img",{attrs:{src:"images/1228818-20180412195441627-591467366.png",alt:"img"}})]),a._v(" "),s("p",[a._v("点击继续前往hadoop3（不安全）")]),a._v(" "),s("p",[s("img",{attrs:{src:"images/1228818-20180412195549203-1731990809.png",alt:"img"}})]),a._v(" "),s("p",[a._v("此时会跳到登录界面，输入在配置文件"),s("strong",[a._v("azkaban-users.xml")]),a._v("，中配置的用户名密码"),s("strong",[a._v("admin/admin")]),a._v("，点击登录")]),a._v(" "),s("p",[s("img",{attrs:{src:"images/1228818-20180412195831611-494393778.png",alt:"img"}})]),a._v(" "),s("p",[a._v("登录成功")]),a._v(" "),s("p",[s("img",{attrs:{src:"images/1228818-20180412195935672-176188228.png",alt:"img"}})])])}),[],!1,null,null,null);e.default=r.exports}}]);