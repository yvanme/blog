(window.webpackJsonp=window.webpackJsonp||[]).push([[120],{478:function(a,s,e){"use strict";e.r(s);var t=e(44),r=Object(t.a)({},(function(){var a=this,s=a.$createElement,e=a._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"docker基本使用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker基本使用"}},[a._v("#")]),a._v(" docker基本使用")]),a._v(" "),e("h2",{attrs:{id:"介绍"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#介绍"}},[a._v("#")]),a._v(" 介绍")]),a._v(" "),e("p",[a._v("[TOC]")]),a._v(" "),e("p",[e("strong",[a._v("环境：CentOS7")])]),a._v(" "),e("h2",{attrs:{id:"一、配置远程访问"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一、配置远程访问"}},[a._v("#")]),a._v(" 一、配置远程访问")]),a._v(" "),e("p",[a._v("1、在/usr/lib/systemd/system/docker.service，配置远程访问。主要是在[Service]这个部分，加上下面两个参数")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" /usr/lib/systemd/system/docker.service  \n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("Service"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("  \n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("ExecStart")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("  \n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("ExecStart")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/usr/bin/dockerd -H tcp://0.0.0.0:2375 -H unix://var/run/docker.sock\n")])])]),e("p",[a._v("2、docker重新读取配置文件，重新启动docker服务")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("systemctl daemon-reload\nsystemctl restart docker\n")])])]),e("p",[a._v("3、查看docker进程，发现docker守护进程在已经监听2375的tcp端口")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("ps")]),a._v(" -ef"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("grep")]),a._v(" docker\n")])])]),e("p",[a._v("4、这里拿本地客户端，来访问CentOS7的docker服务，访问成功")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("docker -H tcp://139.129.130.123:2375 images\n")])])]),e("h2",{attrs:{id:"二、容器管理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二、容器管理"}},[a._v("#")]),a._v(" 二、容器管理")]),a._v(" "),e("p",[a._v("1、查看运行容器")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("docker "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("ps")]),a._v("\n")])])]),e("p",[a._v("2、查看所有容器")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("docker "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("ps")]),a._v(" -a\n")])])]),e("p",[a._v("3、进入容器（其中字符串为容器ID）")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("docker "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exec")]),a._v(" -it d27bd3008ad9 /bin/bash\n")])])]),e("p",[a._v("4、将主机/www/runoob目录拷贝到容器96f7f14e99ab的/www目录下")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("docker "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" /www/runoob 96f7f14e99ab:/www/\n")])])]),e("p",[a._v("5、将主机/www/runoob目录拷贝到容器96f7f14e99ab中，目录重命名为www")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("docker "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" /www/runoob 96f7f14e99ab:/www\n")])])]),e("p",[a._v("6、将容器96f7f14e99ab的/www目录拷贝到主机的/tmp目录中")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("docker "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v("  96f7f14e99ab:/www /tmp/\n")])])]),e("p",[a._v("7、在容器内拷贝")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("docker run -v /path/to/hostdir:/mnt "),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$container")]),a._v(" \n"),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" /mnt/sourcefile /path/to/destfile  \n")])])]),e("p",[a._v("8、杀死所有running状态的容器")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("docker "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("kill")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),a._v("docker "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("ps")]),a._v(" -q"),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v("\n")])])]),e("p",[a._v("9、停用全部运行中的容器:")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("docker stop "),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),a._v("docker "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("ps")]),a._v(" -q"),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v("\n")])])]),e("p",[a._v("10、删除所有已经停止的容器")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("docker "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("rm")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),a._v("docker "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("ps")]),a._v(" -a -q"),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v("\n")])])]),e("p",[a._v("11、一条命令实现停用并删除容器")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("docker stop "),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),a._v("docker "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("ps")]),a._v(" -q"),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),a._v(" docker "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("rm")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),a._v("docker "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("ps")]),a._v(" -aq"),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v("\n")])])]),e("p",[a._v("三、镜像管理")]),a._v(" "),e("p",[a._v("1、批量删除镜像：（删除所有名字中带 “none” 关键字的镜像）")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v(" docker rmi "),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),a._v("docker images "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("grep")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"info"')]),a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("awk")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v("'{print $3}'")]),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v(" \n")])])]),e("p",[a._v("2、删除所有'untagged/dangling' ()状态的镜像")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("docker rmi "),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),a._v("docker images -q -f "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("dangling")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("true"),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v("\n")])])]),e("p",[a._v("3、删除所有镜像：")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("docker rmi "),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),a._v("docker images -q"),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v("\n")])])]),e("p",[a._v("四、镜像的导入导出")]),a._v(" "),e("p",[a._v("1、镜像导出：（其中：infoarchivesapi为镜像名称，infoarchivesapi.tar为导出备份名称）")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("docker save -o infoarchivesapi.tar infoarchivesapi\n")])])]),e("p",[a._v("2、镜像导入：（infoarchivesapi.tar为导入备份名称）")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("docker load -i infoarchivesapi.tar\n")])])])])}),[],!1,null,null,null);s.default=r.exports}}]);