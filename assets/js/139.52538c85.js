(window.webpackJsonp=window.webpackJsonp||[]).push([[139],{504:function(s,t,a){"use strict";a.r(t);var n=a(27),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"jenkins构建发布vue项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jenkins构建发布vue项目"}},[s._v("#")]),s._v(" Jenkins构建发布Vue项目")]),s._v(" "),a("h2",{attrs:{id:"介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#介绍"}},[s._v("#")]),s._v(" 介绍")]),s._v(" "),a("p",[s._v("[TOC]")]),s._v(" "),a("p",[a("strong",[s._v("安装环境：")])]),s._v(" "),a("p",[a("strong",[s._v("system：CentOS7")])]),s._v(" "),a("h2",{attrs:{id:"jenkins构建发布vue项目-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jenkins构建发布vue项目-2"}},[s._v("#")]),s._v(" Jenkins构建发布Vue项目")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("安装nodejs插件")]),s._v(" "),a("p",[a("img",{attrs:{src:"images/1.png",alt:""}})])]),s._v(" "),a("li",[a("p",[s._v("系统管理，全局工具配置，新增nodejs配置")]),s._v(" "),a("p",[a("img",{attrs:{src:"images/2.png",alt:""}})])]),s._v(" "),a("li",[a("p",[s._v("新建自由流任务")]),s._v(" "),a("p",[a("img",{attrs:{src:"images/3.png",alt:""}})])]),s._v(" "),a("li",[a("p",[s._v("配置任务")]),s._v(" "),a("p",[a("img",{attrs:{src:"images/4.png",alt:""}})]),s._v(" "),a("p",[a("img",{attrs:{src:"images/5.png",alt:"5"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"images/6.png",alt:"6"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"images/7.png",alt:"7"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"images/8.png",alt:"8"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"images/9.png",alt:"9"}})])])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#shell")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /var/lib/jenkins/workspace/NodeJS项目\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" run build:prod\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" dist \n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf dist.tar.gz   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除上次打包生成的压缩文件，打包的时候会自动删除整个dist文件夹无需这一步")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -zcvf dist.tar.gz *   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#把新生成的项目打包tar包方便传输到远程服务器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#command")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /apps/html\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#判断文件夹是否存在")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("target")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/local/nginx/html/dist"')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#判断文件夹是否存在 -d")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" -d "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$target")]),s._v('"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$target")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" /apps/html/dist.tar.gz "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$target")]),s._v("/\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$target")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -xf dist.tar.gz            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#进行解压")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf  dist.tar.gz           "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#解压完成后删掉解压包")]),s._v("\n/usr/local/nginx/sbin/nginx -s reload\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("p",[s._v("5.nginx配置")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("location /dist/ {\n        root   html;\n    try_files $uri $uri/ /dist/index.html;\n        index  index.html index.htm;\n    }\n\t\nlocation /prod-api/{\n\tproxy_set_header Host $http_host;\n\tproxy_set_header X-Real-IP $remote_addr;\n\tproxy_set_header REMOTE-HOST $remote_addr;\n\tproxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n\tproxy_pass http://localhost:8080/;\n}\n")])])]),a("ol",{attrs:{start:"6"}},[a("li",[s._v("构建任务")])])])}),[],!1,null,null,null);t.default=e.exports}}]);